<!DOCTYPE html>
<html>

<head>
    <title>API Test</title>
</head>

<body>
    <h1>Testing VPN Panel APIs</h1>
    <div id="results"></div>

    <script>
        const token = localStorage.getItem('token');
        const baseURL = 'http://localhost:8000/api/v1';

        const endpoints = [
            '/monitoring/dashboard',
            '/monitoring/traffic-stats?days=7',
            '/monitoring/traffic-by-type?days=7',
            '/monitoring/active-connections',
            '/notifications',
            '/notifications/unread-count',
            '/activity/recent'
        ];

        async function testEndpoint(endpoint) {
            try {
                const response = await fetch(baseURL + endpoint, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });

                if (response.ok) {
                    const data = await response.json();
                    return { endpoint, status: 'OK', data };
                } else {
                    const text = await response.text();
                    return { endpoint, status: 'ERROR', code: response.status, error: text };
                }
            } catch (error) {
                return { endpoint, status: 'FAILED', error: error.message };
            }
        }

        async function testAll() {
            const results = document.getElementById('results');
            results.innerHTML = '<p>Testing endpoints...</p>';

            for (const endpoint of endpoints) {
                const result = await testEndpoint(endpoint);
                const div = document.createElement('div');
                div.style.marginBottom = '20px';
                div.style.padding = '10px';
                div.style.border = '1px solid #ccc';
                div.style.backgroundColor = result.status === 'OK' ? '#d4edda' : '#f8d7da';

                div.innerHTML = `
                    <strong>${endpoint}</strong><br>
                    Status: ${result.status}<br>
                    ${result.code ? `Code: ${result.code}<br>` : ''}
                    ${result.error ? `Error: ${result.error}<br>` : ''}
                    ${result.data ? `Data: <pre>${JSON.stringify(result.data, null, 2)}</pre>` : ''}
                `;

                results.appendChild(div);
            }
        }

        testAll();
    </script>
</body>

</html>